<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ruleta Bienvenida (Pacientes Nuevos)</title>
  <style>
    :root{--bg:#f4f6f8;--card:#fff;--border:#e5e7eb;--text:#111827;--muted:#6b7280;--primary:#1d3557;--accent:#e63946;}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:Arial,system-ui,-apple-system,Segoe UI,Roboto;}
    .wrap{max-width:1020px;margin:0 auto;padding:16px;display:grid;grid-template-columns:1fr 420px;gap:16px;align-items:start;}
    @media (max-width:980px){.wrap{grid-template-columns:1fr;}}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 10px 22px rgba(0,0,0,.06);padding:16px;}
    h1{margin:0 0 6px;font-size:22px}
    .sub{margin:0 0 14px;color:var(--muted);font-size:13px;line-height:1.35}

    /* Wheel */
    .wheel-area{display:flex;flex-direction:column;align-items:center;gap:10px}
    .wheel-container{position:relative;width:min(380px,100%);aspect-ratio:1/1;}
    canvas{width:100%;height:100%;border-radius:999px;background:#fff;}
    .pointer{position:absolute;top:-6px;left:50%;transform:translateX(-50%);
      width:0;height:0;border-left:14px solid transparent;border-right:14px solid transparent;border-bottom:28px solid var(--accent);
      filter:drop-shadow(0 2px 2px rgba(0,0,0,.18));}

    /* Form */
    label{display:block;font-size:12px;color:var(--muted);margin:10px 0 6px}
    input,select{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;font-size:14px;outline:none;background:#fff;}
    input:focus,select:focus{border-color:#93c5fd;box-shadow:0 0 0 3px rgba(59,130,246,.15)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:520px){.row{grid-template-columns:1fr}}

    .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    button{border:none;border-radius:12px;padding:12px 14px;font-size:14px;font-weight:800;cursor:pointer}
    .btn-primary{background:var(--primary);color:#fff}
    .btn-ghost{background:#eef2ff;color:#111827}
    .btn-danger{background:#fee2e2;color:#7f1d1d}
    button:disabled{opacity:.55;cursor:not-allowed}

    .result{font-weight:900;color:var(--primary);font-size:16px;min-height:22px;text-align:center}
    .warn{display:none;margin-top:10px;padding:10px 12px;border-radius:12px;background:#fff7ed;border:1px solid #fed7aa;color:#9a3412;font-size:13px;line-height:1.35}

    table{width:100%;border-collapse:collapse;font-size:12px}
    th,td{border-bottom:1px solid var(--border);padding:8px;text-align:left;vertical-align:top}
    th{color:var(--muted);font-weight:800}
    .scroll{max-height:280px;overflow:auto;border:1px solid var(--border);border-radius:12px}

    .topline{display:flex;justify-content:space-between;align-items:flex-start;gap:10px;flex-wrap:wrap}
    .pill{display:inline-block;font-size:12px;background:#f3f4f6;border:1px solid var(--border);padding:6px 10px;border-radius:999px;color:#111827}

    /* Pseudo Fullscreen fallback */
    body.pseudo-fs{overflow:hidden}
    body.pseudo-fs .wrap{position:fixed;inset:0;max-width:none;margin:0;padding:12px;background:var(--bg);z-index:99999;overflow:auto;grid-template-columns:1fr 460px;}
    @media (max-width:980px){body.pseudo-fs .wrap{grid-template-columns:1fr;}}

    /* Debug */
    .debug{margin-top:12px;font-size:12px;color:var(--muted)}
    .debug b{color:var(--text)}
    .debug .ok{color:#166534;font-weight:800}
    .debug .bad{color:#991b1b;font-weight:800}
  </style>
</head>
<body>

<div class="wrap">
  <!-- RUEDA -->
  <div class="card">
    <div class="topline">
      <div>
        <h1>üé° Ruleta Bienvenida</h1>
        <p class="sub">Pacientes nuevos ¬∑ Beneficio v√°lido solo si <b>agenda + paga hoy</b>. 1 giro por paciente/d√≠a/sucursal.</p>
      </div>
      <div class="btns" style="margin-top:0">
        <button class="btn-ghost" id="fullscreenBtn" type="button">Pantalla completa</button>
      </div>
    </div>

    <div class="wheel-area">
      <div class="wheel-container">
        <div class="pointer"></div>
        <canvas id="wheel" width="380" height="380"></canvas>
      </div>
      <div class="result" id="result"></div>
    </div>

    <div class="debug" id="debug"></div>
  </div>

  <!-- CONTROLES -->
  <div class="card">
    <div class="pill" id="todayPill"></div>

    <label for="branch">Sucursal</label>
    <select id="branch"></select>

    <div class="row">
      <div>
        <label for="patientId">ID paciente (RUT o c√≥digo)</label>
        <input id="patientId" placeholder="Ej: 12.345.678-9" />
      </div>
      <div>
        <label for="seller">Ejecutivo</label>
        <input id="seller" placeholder="Ej: Camila" />
      </div>
    </div>

    <div class="row">
      <div>
        <label for="amount">Monto abonado hoy (CLP)</label>
        <input id="amount" type="number" min="0" step="1000" placeholder="Ej: 50000" />
      </div>
      <div>
        <label for="treatment">Tratamiento / Plan</label>
        <input id="treatment" placeholder="Ej: Implante / Orto / Reha" />
      </div>
    </div>

    <div class="btns">
      <button class="btn-primary" id="spinBtn" type="button">GIRAR RULETA</button>
      <button class="btn-ghost" id="previewBtn" type="button">Ver premios</button>
    </div>

    <div class="warn" id="warning"></div>

    <hr style="border:none;border-top:1px solid var(--border);margin:14px 0" />

    <div class="topline">
      <div>
        <div style="font-weight:900">Registro (local)</div>
        <div class="sub" style="margin:6px 0 0">Se guarda en este dispositivo. Exporta a CSV para consolidar.</div>
      </div>
      <div class="btns" style="margin-top:0">
        <button class="btn-ghost" id="exportBtn" type="button">Exportar CSV</button>
        <button class="btn-danger" id="clearBtn" type="button">Borrar</button>
      </div>
    </div>

    <div class="scroll" style="margin-top:10px">
      <table>
        <thead>
          <tr>
            <th>Fecha</th>
            <th>Sucursal</th>
            <th>ID</th>
            <th>Ejecutivo</th>
            <th>Premio</th>
            <th>Monto</th>
          </tr>
        </thead>
        <tbody id="logBody"></tbody>
      </table>
    </div>
  </div>
</div>

<script>
(function(){
  'use strict';

  // ============================
  // CONFIG (premios por sucursal)
  // weight = probabilidad relativa
  // ============================
  const PRIZES_BY_BRANCH = {
    "Providencia": [
      { label: "RX gratis", weight: 18 },
      { label: "Siga participando", weight: 8 },
      { label: "Control sin costo", weight: 18 },
      { label: "Siga participando", weight: 8 },
      { label: "10% OFF en tratamiento", weight: 14 },
      { label: "Siga participando", weight: 8 },
      { label: "5% OFF en tratamiento", weight: 10 },
      { label: "Siga participando", weight: 8 },
      { label: "$30.000 de descuento", weight: 14 },
      { label: "Kit de higiene premium", weight: 14 },
      { label: "Limpieza dental gratis", weight: 12 },
      { label: "Blanqueamiento 50% OFF", weight: 8 }
    ],
    "Los Andes": [
      { label: "RX gratis", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "Control sin costo", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "$30.000 de descuento", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "10% OFF en tratamiento", weight: 14 },
      { label: "Siga participando", weight: 8 },
      { label: "5% OFF en tratamiento", weight: 10 },
      { label: "Limpieza dental gratis", weight: 14 },
      { label: "Kit de higiene premium", weight: 14 },
      { label: "Blanqueamiento 50% OFF", weight: 10 }
    ],
    "San Felipe": [
      { label: "RX gratis", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "Control sin costo", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "$30.000 de descuento", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "10% OFF en tratamiento", weight: 14 },
      { label: "Siga participando", weight: 8 },
      { label: "5% OFF en tratamiento", weight: 10 },
      { label: "Limpieza dental gratis", weight: 14 },
      { label: "Kit de higiene premium", weight: 14 },
      { label: "Blanqueamiento 50% OFF", weight: 10 }
    ],
    "Osorno": [
      { label: "RX gratis", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "Control sin costo", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "$30.000 de descuento", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "10% OFF en tratamiento", weight: 14 },
      { label: "Siga participando", weight: 8 },
      { label: "5% OFF en tratamiento", weight: 10 },
      { label: "Limpieza dental gratis", weight: 14 },
      { label: "Kit de higiene premium", weight: 14 },
      { label: "Blanqueamiento 50% OFF", weight: 10 }
    ],
    "Metro Santa Ana": [
      { label: "RX gratis", weight: 18 },
      { label: "Siga participando", weight: 8 },
      { label: "Control sin costo", weight: 18 },
      { label: "Siga participando", weight: 8 },
      { label: "10% OFF en tratamiento", weight: 14 },
      { label: "Siga participando", weight: 8 },
      { label: "5% OFF en tratamiento", weight: 10 },
      { label: "Siga participando", weight: 8 },
      { label: "$30.000 de descuento", weight: 14 },
      { label: "Kit de higiene premium", weight: 14 },
      { label: "Limpieza dental gratis", weight: 12 },
      { label: "Blanqueamiento 50% OFF", weight: 8 }
    ],
    "Metro Cumming": [
      { label: "RX gratis", weight: 18 },
      { label: "Siga participando", weight: 8 },
      { label: "Control sin costo", weight: 18 },
      { label: "Siga participando", weight: 8 },
      { label: "10% OFF en tratamiento", weight: 14 },
      { label: "Siga participando", weight: 8 },
      { label: "5% OFF en tratamiento", weight: 10 },
      { label: "Siga participando", weight: 8 },
      { label: "$30.000 de descuento", weight: 14 },
      { label: "Kit de higiene premium", weight: 14 },
      { label: "Limpieza dental gratis", weight: 12 },
      { label: "Blanqueamiento 50% OFF", weight: 8 }
    ],
    "San Bernardo": [
      { label: "RX gratis", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "Control sin costo", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "$30.000 de descuento", weight: 16 },
      { label: "Siga participando", weight: 8 },
      { label: "10% OFF en tratamiento", weight: 14 },
      { label: "Siga participando", weight: 8 },
      { label: "5% OFF en tratamiento", weight: 10 },
      { label: "Limpieza dental gratis", weight: 14 },
      { label: "Kit de higiene premium", weight: 14 },
      { label: "Blanqueamiento 50% OFF", weight: 10 }
    ]
  };

  // ============================
  // DOM
  // ============================
  const canvas = document.getElementById('wheel');
  const ctx = canvas.getContext('2d');
  const branchEl = document.getElementById('branch');
  const patientIdEl = document.getElementById('patientId');
  const sellerEl = document.getElementById('seller');
  const amountEl = document.getElementById('amount');
  const treatmentEl = document.getElementById('treatment');
  const spinBtn = document.getElementById('spinBtn');
  const previewBtn = document.getElementById('previewBtn');
  const exportBtn = document.getElementById('exportBtn');
  const clearBtn = document.getElementById('clearBtn');
  const fullscreenBtn = document.getElementById('fullscreenBtn');
  const resultEl = document.getElementById('result');
  const warningEl = document.getElementById('warning');
  const logBody = document.getElementById('logBody');
  const todayPill = document.getElementById('todayPill');
  const debugEl = document.getElementById('debug');

  // ============================
  // Storage
  // ============================
  const STORAGE_KEY_LOG = 'dentimagen_ruleta_log_v3';
  const STORAGE_KEY_SPINS = 'dentimagen_ruleta_spins_v3';

  function todayISO(){
    const d = new Date();
    const yyyy = d.getFullYear();
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const dd = String(d.getDate()).padStart(2,'0');
    return `${yyyy}-${mm}-${dd}`;
  }
  todayPill.textContent = `Hoy: ${todayISO()}`;

  function getJSON(key, fallback){
    try{ return JSON.parse(localStorage.getItem(key) || JSON.stringify(fallback)); }
    catch{ return fallback; }
  }
  function setJSON(key, value){
    localStorage.setItem(key, JSON.stringify(value));
  }

  function normalizeId(raw){
    return String(raw||'').trim().toUpperCase();
  }

  // ============================
  // Populate branches
  // ============================
  function populateBranches(){
    const branches = Object.keys(PRIZES_BY_BRANCH);
    branchEl.innerHTML = '';
    for(const b of branches){
      const opt = document.createElement('option');
      opt.value = b;
      opt.textContent = b;
      branchEl.appendChild(opt);
    }
    if(branches.length > 0) branchEl.value = branches[0];
    return branches.length;
  }

  function currentPrizes(){
    return PRIZES_BY_BRANCH[branchEl.value] || [];
  }

  // ============================
  // Wheel drawing
  // ============================
  let angle = 0;
  let spinning = false;

  function drawWheel(){
    const prizes = currentPrizes().map(p => p.label);
    const n = Math.max(1, prizes.length);
    const arc = (2*Math.PI)/n;

    ctx.clearRect(0,0,canvas.width,canvas.height);

    for(let i=0;i<n;i++){
      ctx.beginPath();
      ctx.moveTo(canvas.width/2, canvas.height/2);
      ctx.fillStyle = (i%2===0) ? '#3F6EA8' : '#8BAE5C';
      ctx.arc(canvas.width/2, canvas.height/2, canvas.width/2 - 4, angle + i*arc, angle + (i+1)*arc);
      ctx.fill();

      ctx.save();
      ctx.translate(canvas.width/2, canvas.height/2);
      ctx.rotate(angle + i*arc + arc/2);
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillStyle = '#ffffff';
      ctx.font = 'bold 12px Arial';
      // Texto m√°s centrado dentro del segmento
      ctx.fillText(prizes[i] || '', canvas.width/2 - 80, 0);
      ctx.restore();
    }

    ctx.beginPath();
    ctx.arc(canvas.width/2, canvas.height/2, 28, 0, 2*Math.PI);
    ctx.fillStyle = '#111827';
    ctx.fill();
    ctx.fillStyle = '#fff';
    ctx.font = 'bold 9px Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('Dentimagen', canvas.width/2, canvas.height/2 + 1);
  }

  // ============================
  // Weighted pick
  // ============================
  function pickWeighted(list){
    const total = list.reduce((s,p)=>s + (p.weight||0), 0);
    let r = Math.random()*total;
    for(const p of list){
      r -= (p.weight||0);
      if(r <= 0) return p;
    }
    return list[list.length-1];
  }

  function targetAngleForIndex(index, size){
    const arc = (2*Math.PI)/size;
    const pointerAngle = -Math.PI/2;
    const segmentCenter = index*arc + arc/2;
    let a = pointerAngle - segmentCenter;
    a = (a % (2*Math.PI) + 2*Math.PI) % (2*Math.PI);
    return a;
  }

  function showWarn(msg){
    warningEl.style.display = 'block';
    warningEl.textContent = msg;
  }
  function clearWarn(){
    warningEl.style.display = 'none';
    warningEl.textContent = '';
  }

  function canSpin(){
    clearWarn();
    const id = normalizeId(patientIdEl.value);
    if(!id) { showWarn('Falta el ID del paciente (RUT o c√≥digo).'); return false; }

    const amount = Number(amountEl.value || 0);
    if(!(amount > 0)) { showWarn('Para girar, registra el monto abonado hoy (mayor a 0).'); return false; }

    const spins = getJSON(STORAGE_KEY_SPINS, {});
    const key = `${todayISO()}::${branchEl.value}::${id}`;
    if(spins[key]) { showWarn('Este paciente ya gir√≥ hoy en esta sucursal.'); return false; }

    return true;
  }

  function markSpun(){
    const id = normalizeId(patientIdEl.value);
    const spins = getJSON(STORAGE_KEY_SPINS, {});
    const key = `${todayISO()}::${branchEl.value}::${id}`;
    spins[key] = true;
    setJSON(STORAGE_KEY_SPINS, spins);
  }

  function addLog(prize){
    const rows = getJSON(STORAGE_KEY_LOG, []);
    rows.push({
      date: new Date().toISOString(),
      branch: branchEl.value,
      patientId: normalizeId(patientIdEl.value),
      seller: String(sellerEl.value||'').trim(),
      amount: Number(amountEl.value||0),
      treatment: String(treatmentEl.value||'').trim(),
      prize
    });
    setJSON(STORAGE_KEY_LOG, rows);
  }

  function renderLog(){
    const rows = getJSON(STORAGE_KEY_LOG, []);
    logBody.innerHTML = '';
    const last = rows.slice().reverse().slice(0, 50);
    for(const r of last){
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${r.date}</td>
        <td>${r.branch}</td>
        <td>${r.patientId}</td>
        <td>${r.seller || ''}</td>
        <td><b>${r.prize}</b></td>
        <td>${r.amount || 0}</td>
      `;
      logBody.appendChild(tr);
    }
  }

  function spinToIndex(chosenIndex, size){
    const baseTarget = targetAngleForIndex(chosenIndex, size);
    const extraTurns = (Math.floor(Math.random()*3) + 6) * 2*Math.PI;

    const startAngle = angle;
    const currentNorm = (startAngle % (2*Math.PI) + 2*Math.PI) % (2*Math.PI);
    let delta = baseTarget - currentNorm;
    if(delta < 0) delta += 2*Math.PI;
    const target = startAngle + extraTurns + delta;

    const duration = 4200 + Math.random()*600;
    const start = performance.now();
    const easeOut = t => 1 - Math.pow(1-t, 3);

    function anim(now){
      const t = Math.min(1, (now-start)/duration);
      angle = startAngle + (target-startAngle)*easeOut(t);
      drawWheel();
      if(t<1) requestAnimationFrame(anim);
      else { angle = target; drawWheel(); spinning=false; spinBtn.disabled=false; }
    }

    requestAnimationFrame(anim);
  }

  // ============================
  // "Tests" (runtime self-checks)
  // ============================
  function assert(name, condition){
    return { name, ok: !!condition };
  }

  function renderDebug(results){
    const okCount = results.filter(r=>r.ok).length;
    const allOk = okCount === results.length;
    const lines = results.map(r => `${r.ok ? '‚úÖ' : '‚ùå'} ${r.name}`).join(' ¬∑ ');
    debugEl.innerHTML = `<b>Auto-check:</b> <span class="${allOk ? 'ok' : 'bad'}">${okCount}/${results.length}</span><div>${lines}</div>`;
  }

  // ============================
  // Events
  // ============================
  branchEl.addEventListener('change', () => { resultEl.textContent=''; drawWheel(); });

  previewBtn.addEventListener('click', () => {
    const list = currentPrizes().map(p => `‚Ä¢ ${p.label} (peso ${p.weight})`).join('\n');
    alert(`Premios para ${branchEl.value}:\n\n${list}`);
  });

  spinBtn.addEventListener('click', () => {
    if(spinning) return;
    if(!canSpin()) return;

    spinning = true;
    spinBtn.disabled = true;
    resultEl.textContent = '';

    const prizes = currentPrizes();
    const chosen = pickWeighted(prizes);
    const idx = prizes.findIndex(p => p.label === chosen.label);

    markSpun();
    addLog(chosen.label);
    renderLog();

    resultEl.textContent = `üéâ Premio: ${chosen.label}`;
    spinToIndex(Math.max(0, idx), prizes.length);
  });

  exportBtn.addEventListener('click', () => {
    const rows = getJSON(STORAGE_KEY_LOG, []);
    const headers = ['date','branch','patientId','seller','amount','treatment','prize'];

    const csvBody = rows.map(r =>
      headers.map(h => {
        const v = r[h] ?? '';
        return `"${String(v).replace(/"/g, '""')}"`;
      }).join(',')
    );

    const csv = [headers.join(','), ...csvBody].join('\n');

    // BOM UTF-8 para Excel
    const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });

    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `ruleta_dentimagen_${todayISO()}.csv`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });

  clearBtn.addEventListener('click', () => {
    const ok = confirm('Esto borrar√° el registro y los bloqueos de giro en ESTE dispositivo. ¬øContinuar?');
    if(!ok) return;
    localStorage.removeItem(STORAGE_KEY_LOG);
    localStorage.removeItem(STORAGE_KEY_SPINS);
    renderLog();
    resultEl.textContent='';
    clearWarn();
  });

  // Pantalla completa: usa Fullscreen API cuando est√© disponible.
// Fallback: pseudo-fullscreen (CSS) para navegadores que lo bloquean (ej. algunos iOS/Safari/embeds).
function setPseudoFullscreen(on){
    document.body.classList.toggle('pseudo-fs', on);
    fullscreenBtn.textContent = on ? 'Salir de pantalla completa' : 'Pantalla completa';
}

fullscreenBtn.addEventListener('click', async () => {
    try{
      // Preferimos fullscreen sobre el contenedor principal para evitar glitches
      const target = document.querySelector('.wrap') || document.documentElement;

      if(document.fullscreenElement){
        await document.exitFullscreen();
        setPseudoFullscreen(false);
        return;
      }

      // Algunos navegadores requieren gesto del usuario (click) ‚Äî ya lo tenemos.
      if(target.requestFullscreen){
        await target.requestFullscreen({ navigationUI: 'hide' });
        fullscreenBtn.textContent = 'Salir de pantalla completa';
      } else {
        // Fallback
        setPseudoFullscreen(!document.body.classList.contains('pseudo-fs'));
      }
    } catch(e){
      // Fallback si la API falla o est√° bloqueada
      setPseudoFullscreen(!document.body.classList.contains('pseudo-fs'));
    }
  });

// Mantener texto del bot√≥n sincronizado si el usuario sale con ESC
document.addEventListener('fullscreenchange', () => {
    fullscreenBtn.textContent = document.fullscreenElement ? 'Salir de pantalla completa' : 'Pantalla completa';
    if(!document.fullscreenElement) setPseudoFullscreen(false);
});

  // ============================
  // Init
  // ============================
  const branchCount = populateBranches();
  drawWheel();
  renderLog();

  function validatePrizes(){
    const errs = [];
    const keys = Object.keys(PRIZES_BY_BRANCH);
    if(keys.length === 0) errs.push('PRIZES_BY_BRANCH vac√≠o');
    for(const k of keys){
      const arr = PRIZES_BY_BRANCH[k];
      if(!Array.isArray(arr) || arr.length === 0){
        errs.push(`Sucursal sin premios: ${k}`);
        continue;
      }
      for(const [idx,p] of arr.entries()){
        if(!p || typeof p.label !== 'string' || !p.label.trim()) errs.push(`Premio inv√°lido en ${k}[${idx}]`);
        if(typeof p.weight !== 'number' || !(p.weight > 0)) errs.push(`Weight inv√°lido en ${k}[${idx}]`);
      }
    }
    return errs;
  }

  const prizeErrs = validatePrizes();

  const checks = [
    assert('Canvas disponible', !!canvas && !!ctx),
    assert('Sucursales cargadas', branchCount > 0),
    assert('Premios cargados para sucursal', currentPrizes().length > 0),
    assert('Config premios v√°lida', prizeErrs.length === 0)
  ];
  renderDebug(checks);

})();
</script>

</body>
</html>
